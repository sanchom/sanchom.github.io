name: deploy-to-live
on:
  push:
    branches:
      - master-source

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Step up one directory
        run: cd ../
      - name: Pull my custom pollen Docker image
        run: docker pull sanchom/pollen
      - name: Start container
        run: docker run -v `pwd`:/work --name racket_container -d sanchom/pollen tail -f /dev/null
      - name: Install latest pollen dependencies in container
        run: docker exec racket_container raco pkg install pollen-citations-mcgill
      - name: Shut down container
        run: docker rm -f racket_container
