name: deploy-to-live
on:
  push:
    branches:
      - master-source

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Stepping up one directory
        run: cd ../
      - name: Pulling my custom pollen Docker image
        run: docker pull sanchom/pollen
      - name: Starting container
        run: docker run -v `pwd`:/work --name racket_container -d sanchom/pollen tail -f /dev/null
      - name: Installing latest pollen dependencies in container
        run: docker exec racket_container raco pkg install pollen-citations-mcgill
      - name: Inspecting work directory
        run: docker exec racket_container ls /work
      - name: Shuting down container
        run: docker rm -f racket_container
